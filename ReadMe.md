# ファミメムエディタ v0.9
2019/09/10(火)  
[はるきのへや.みんな](https://はるきのへや.みんな/1.ｹﾞ-ﾑ･技術/製作物/ﾌｧﾐﾒﾑｴﾃﾞｨﾀ/)  

---
### ■ 概要
ファミコン用メモリエディタです。  
入力した 16 進数を機械語としてそのまま実行する機能も備わっています。  

### ■ 操作方法

|||
|-|-|
| [A] + 十時キー | カーソル移動 |
| [B] + 十時キー | ページ移動 |
| [十時キー] + A or B | 16進数値入力 (0-F) |
| SELECT | 機械語として実行 (表示ﾍﾟｰｼﾞ先頭ｱﾄﾞﾚｽから) |

※ [ ] は、"押しながら" を意味します。

---
### ■ サンプル : BPS社サウンドロゴ似の音

エミュレータは [Mesen](https://www.mesen.ca/ja/) をご使用下さい。
  1. 設定 → 設定 で設定ウインドウを開く
  2. その他 "開発者モードを有効にする" : ON
  3. 設定ウインドウを OK で閉じる
  4. Debug → Memory Tools でメモリツールウインドウを開く
  5. 下に記述されている機械語プログラムをコピー
  6. 0000 番地にカーソルを合わせて右クリック → Paste
  7. メモリツールウインドウを閉じる  
     (ここで、ファミメムエディタの画面にも反映される)
  8. セレクトボタンを押す
  9. BPS社風サウンドロゴが鳴ります！

```
A2 00 A0 00 
A5 24 91 20 
B5 28 91 22 
E8 C8 00 00 
E0 08 D0 F4 
60 00 00 00 
00 00 00 00 
00 00 00 00 
15 40 00 40 
03 00 00 00 
B8 AF FF 03 
B8 AF FC 03 
00 00 00 00 
00 00 00 00 
00 00 00 00 
00 00 00 00
```

上記の機械語をアセンブリで表すと、以下となります。

```LLVM
; x, y ﾚｼﾞｽﾀ に 0 代入。
ldx #$00
ldy #$00
; $24 から a ﾚｼﾞｽﾀ に読み込み、
; a ﾚｼﾞｽﾀ の値を $20 が指すｱﾄﾞﾚｽ($4015) + y 番地 に書き込む。
lda $24
sta ($20), y
; ここから繰り返し処理
-
    ; $28 + x 番地の値を a に読み込み、
    ; $22 が指すｱﾄﾞﾚｽ($4000) + y 番地 に書き込む。
    lda $28, x
    sta ($22), y
    ; x, y を 1足す。(nop は何もしない命令)
    ; "x != 8" だった場合、"-" まで戻る
    inx
    iny
    nop
    nop
    cpx #$08
bne -
; 実行元に戻る
rts

; パディング
.db    0, 0, 0
.db 0, 0, 0, 0
.db 0, 0, 0, 0

;---------------------------------------------
DATA_dst_Address:
    ; [$4015]ﾁｬﾝﾈﾙ有効ﾚｼﾞｽﾀ, [$4000]矩形波1 制御ﾚｼﾞｽﾀ
    .dw $4015, $4000
DATA_src_4015:
    ; [$4015] 矩形波1, 2有効 (0, 0, 0 は パディング)
    .db $03, 0, 0, 0
DATA_src_4000:
    ; [$4000-$4003] 矩形波1 [ 音色･音量 | ｽｲｰﾌﾟ | 周波数下位 | 周波数上位(ｷｰｵﾝ/ｵﾌ) ]
    ; [$4004-$4007] 矩形波2 [ 音色･音量 | ｽｲｰﾌﾟ | 周波数下位 | 周波数上位 (ｷｰｵﾝ/ｵﾌ) ]
    .db $B8, $AF, $FF, $03 
    .db $B8, $AF, $FC, $03
```

---
参考 : [https://dic.nicovideo.jp/a/fc音源](https://dic.nicovideo.jp/a/fc音源)  

上記リンク先に書かれておりました
>10 POKE &H4015,3  
>20 POKE &H4000,&HB8,&HAF,255,3,&HB8,&HAF,252,3  

を、そのまま機械語で書き直したものです。

-----------

### ■ 更新履歴
- 2019/09/10(火) v0.9 : github にアップロード (ReadMe.txt を修正した上で ReadMe.md に変更)
- 2019/09/08(日) v0.9 : ホームページで公開
